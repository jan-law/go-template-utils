apiVersion: policy.open-cluster-management.io/v1
kind: Policy
metadata:
  name: used-variables-test
spec:
  policy-templates:
    - objectDefinition:
        apiVersion: policy.open-cluster-management.io/v1
        kind: ConfigurationPolicy
        metadata:
          name: should-not-find-unused-variables
        spec:
          object-templates:
            - complianceType: musthave
              objectDefinition:
                apiVersion: v1
                data:
                  something: '0=a 1=b 2=c '
                kind: ConfigMap
                metadata:
                  name: test-range-both-used
                  namespace: default
            - complianceType: musthave
              objectDefinition:
                apiVersion: v1
                data:
                  something: 'zone1 zone2 zone3 '
                kind: ConfigMap
                metadata:
                  name: test-range-single-used
                  namespace: default
            - complianceType: musthave
              objectDefinition:
                apiVersion: v1
                data:
                  something: 'a b c '
                kind: ConfigMap
                metadata:
                  name: test-blank-identifier
                  namespace: default
            - complianceType: musthave
              objectDefinition:
                apiVersion: v1
                data:
                  something: myvalue
                kind: ConfigMap
                metadata:
                  name: test-assign-and-use
                  namespace: default
            - complianceType: musthave
              objectDefinition:
                apiVersion: v1
                data:
                  something: '0=1 1=2 '
                kind: ConfigMap
                metadata:
                  name: test-no-spaces
                  namespace: default
            - complianceType: musthave
              objectDefinition:
                apiVersion: v1
                data:
                  something: '0=1 1=2 '
                kind: ConfigMap
                metadata:
                  name: test-space-before-comma
                  namespace: default
            - complianceType: musthave
              objectDefinition:
                apiVersion: v1
                data:
                  something: let $x := getValue()
                kind: ConfigMap
                metadata:
                  name: test-string-literal
                  namespace: default
            - complianceType: musthave
              objectDefinition:
                apiVersion: v1
                data:
                  something: firstsecond
                kind: ConfigMap
                metadata:
                  name: test-redefine-both-used
                  namespace: default
            - complianceType: musthave
              objectDefinition:
                apiVersion: v1
                data:
                  config:
                    model: Shelby Mustang
                kind: ConfigMap
                metadata:
                  name: test-multiline-with-braces
                  namespace: default
            - complianceType: musthave
              objectDefinition:
                apiVersion: v1
                kind: ConfigMap
                metadata:
                  labels:
                    first: myvalue
                    second: myvalue
                    third: myvalue
                  name: test-cross-field-usage
                  namespace: default
            - complianceType: musthave
              objectDefinition:
                apiVersion: v1
                data:
                  something: Shelby Mustang
                kind: ConfigMap
                metadata:
                  name: test-nested-field-used
                  namespace: default
            - complianceType: musthave
              objectDefinition:
                apiVersion: v1
                data:
                  config:
                    model: Shelby Mustang
                kind: ConfigMap
                metadata:
                  name: test-multiline-with-more-lines
                  namespace: default
            - complianceType: musthave
              objectDefinition:
                apiVersion: v1
                kind: ConfigMap
                metadata:
                  labels:
                    hub-var: something
                  name: first-map
            - complianceType: musthave
              objectDefinition:
                apiVersion: v1
                kind: ConfigMap
                metadata:
                  labels:
                    good-hub-value: hub-value
                  name: second-map
          remediationAction: enforce
          severity: low
